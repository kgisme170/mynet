I'm using spark2.3.1 and scala2.12, referring to this page:
https://github.com/apache/spark/blob/master/examples/src/main/scala/org/apache/spark/examples/sql/UserDefinedTypedAggregation.scala

First, here's employee.json file:

    {"name":"Michael", "salary":3000}
    {"name":"Andy", "salary":4500}
    {"name":"Justin", "salary":3500}
    {"name":"Berta", "salary":4000}

Then scala code:

    import org.apache.spark.SparkConf
    import org.apache.spark.sql._
    object sqlDfRf {
      val conf = new SparkConf().setAppName("spark sql")
        .set("spark.sql.warehouse.dir", System.getProperty("user.dir"))
        .setMaster("local[4]");
      val spark = SparkSession
        .builder()
        .config(conf)
        .getOrCreate()
      def main(args: Array[String]) {
        val df = spark.read.option("multiLine", true).json("employees.json")
        spark.sql("create database people")
        df.write.bucketBy(42,"name").sortBy("salary").saveAsTable("people.bucket")
        df.write.partitionBy("salary").format("parquet").save("3.parquet")
        println("1st result")
        spark.sql("select a,b from parquet.`people.db/bucket`").show() // exception!
        println("2nd result")
        spark.sql("select a,b from parquet.`3.parquet`").show() // exception!
      }
    }

Both spark.sql("select...") statement will throw exception like this:

    Exception in thread "main" org.apache.spark.sql.AnalysisException: cannot resolve '`a`' given input columns: [name, salary]; line 1 pos 7;
    'Project ['a, 'b]
    +- Relation[name#0,salary#1] parquet

        at org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)
